ubuntu@ip-172-31-44-144:~/australia-company-etl-pipeline$ python src/pipeline.py --workers 8 --max-records 200000
2025-12-01 19:20:46,714 - __main__ - INFO - Pipeline initialized with run_id: b469d937
2025-12-01 19:20:46,714 - __main__ - INFO - Workers: 8
2025-12-01 19:20:46,714 - __main__ - INFO - Starting pipeline run: b469d937
2025-12-01 19:20:46,714 - __main__ - INFO - ==================================================
2025-12-01 19:20:46,714 - __main__ - INFO - STEP 1: EXTRACT
2025-12-01 19:20:46,714 - __main__ - INFO - ==================================================
2025-12-01 19:20:46,714 - __main__ - WARNING - Starting call to '__main__.ETLPipeline.extract', this is the 1st time calling it.
2025-12-01 19:20:46,714 - __main__ - INFO - Extracting Common Crawl data...
2025-12-01 19:20:46,715 - src.ingest.download_commoncrawl - INFO - Fetching WET paths from: https://data.commoncrawl.org/crawl-data/CC-MAIN-2025-05/wet.paths.gz
2025-12-01 19:20:47,678 - src.ingest.download_commoncrawl - INFO - Found 90000 WET files
2025-12-01 19:20:47,682 - src.ingest.download_commoncrawl - INFO - Starting parallel download of 10 WET files with 8 workers
2025-12-01 19:20:47,683 - src.ingest.download_commoncrawl - WARNING - Downloading PARTIAL file (10485760 bytes). This will create a truncated gzip that cannot be fully parsed. Use full downloads for production.
2025-12-01 19:20:47,683 - src.ingest.download_commoncrawl - INFO - Downloading first 10485760 bytes of: https://data.commoncrawl.org/crawl-data/CC-MAIN-2025-05/segments/1736703361941.29/wet/CC-MAIN-20250126135402-20250126165402-00000.warc.wet.gz
2025-12-01 19:20:47,683 - src.ingest.download_commoncrawl - WARNING - Downloading PARTIAL file (10485760 bytes). This will create a truncated gzip that cannot be fully parsed. Use full downloads for production.
2025-12-01 19:20:47,685 - src.ingest.download_commoncrawl - INFO - Downloading first 10485760 bytes of: https://data.commoncrawl.org/crawl-data/CC-MAIN-2025-05/segments/1736703361941.29/wet/CC-MAIN-20250126135402-20250126165402-00001.warc.wet.gz
2025-12-01 19:20:47,685 - src.ingest.download_commoncrawl - WARNING - Downloading PARTIAL file (10485760 bytes). This will create a truncated gzip that cannot be fully parsed. Use full downloads for production.
2025-12-01 19:20:47,686 - src.ingest.download_commoncrawl - INFO - Downloading first 10485760 bytes of: https://data.commoncrawl.org/crawl-data/CC-MAIN-2025-05/segments/1736703361941.29/wet/CC-MAIN-20250126135402-20250126165402-00002.warc.wet.gz
2025-12-01 19:20:47,687 - src.ingest.download_commoncrawl - WARNING - Downloading PARTIAL file (10485760 bytes). This will create a truncated gzip that cannot be fully parsed. Use full downloads for production.
2025-12-01 19:20:47,688 - src.ingest.download_commoncrawl - WARNING - Downloading PARTIAL file (10485760 bytes). This will create a truncated gzip that cannot be fully parsed. Use full downloads for production.
2025-12-01 19:20:47,688 - src.ingest.download_commoncrawl - INFO - Downloading first 10485760 bytes of: https://data.commoncrawl.org/crawl-data/CC-MAIN-2025-05/segments/1736703361941.29/wet/CC-MAIN-20250126135402-20250126165402-00003.warc.wet.gz
2025-12-01 19:20:47,689 - src.ingest.download_commoncrawl - WARNING - Downloading PARTIAL file (10485760 bytes). This will create a truncated gzip that cannot be fully parsed. Use full downloads for production.
2025-12-01 19:20:47,689 - src.ingest.download_commoncrawl - WARNING - Downloading PARTIAL file (10485760 bytes). This will create a truncated gzip that cannot be fully parsed. Use full downloads for production.
2025-12-01 19:20:47,689 - src.ingest.download_commoncrawl - INFO - Downloading first 10485760 bytes of: https://data.commoncrawl.org/crawl-data/CC-MAIN-2025-05/segments/1736703361941.29/wet/CC-MAIN-20250126135402-20250126165402-00004.warc.wet.gz
2025-12-01 19:20:47,691 - src.ingest.download_commoncrawl - WARNING - Downloading PARTIAL file (10485760 bytes). This will create a truncated gzip that cannot be fully parsed. Use full downloads for production.
2025-12-01 19:20:47,691 - src.ingest.download_commoncrawl - INFO - Downloading first 10485760 bytes of: https://data.commoncrawl.org/crawl-data/CC-MAIN-2025-05/segments/1736703361941.29/wet/CC-MAIN-20250126135402-20250126165402-00005.warc.wet.gz
2025-12-01 19:20:47,692 - src.ingest.download_commoncrawl - INFO - Downloading first 10485760 bytes of: https://data.commoncrawl.org/crawl-data/CC-MAIN-2025-05/segments/1736703361941.29/wet/CC-MAIN-20250126135402-20250126165402-00006.warc.wet.gz
2025-12-01 19:20:47,693 - src.ingest.download_commoncrawl - INFO - Downloading first 10485760 bytes of: https://data.commoncrawl.org/crawl-data/CC-MAIN-2025-05/segments/1736703361941.29/wet/CC-MAIN-20250126135402-20250126165402-00007.warc.wet.gz
2025-12-01 19:20:50,101 - src.ingest.download_commoncrawl - INFO - Downloaded partial: data/raw/commoncrawl/partial_CC-MAIN-20250126135402-20250126165402-00003.warc.wet.gz (10485761 bytes)
2025-12-01 19:20:50,103 - src.ingest.download_commoncrawl - WARNING - Downloading PARTIAL file (10485760 bytes). This will create a truncated gzip that cannot be fully parsed. Use full downloads for production.
2025-12-01 19:20:50,104 - src.ingest.download_commoncrawl - INFO - Downloading first 10485760 bytes of: https://data.commoncrawl.org/crawl-data/CC-MAIN-2025-05/segments/1736703361941.29/wet/CC-MAIN-20250126135402-20250126165402-00008.warc.wet.gz
2025-12-01 19:20:50,147 - src.ingest.download_commoncrawl - INFO - Downloaded partial: data/raw/commoncrawl/partial_CC-MAIN-20250126135402-20250126165402-00000.warc.wet.gz (10485761 bytes)
2025-12-01 19:20:50,150 - src.ingest.download_commoncrawl - WARNING - Downloading PARTIAL file (10485760 bytes). This will create a truncated gzip that cannot be fully parsed. Use full downloads for production.
2025-12-01 19:20:50,150 - src.ingest.download_commoncrawl - INFO - Downloading first 10485760 bytes of: https://data.commoncrawl.org/crawl-data/CC-MAIN-2025-05/segments/1736703361941.29/wet/CC-MAIN-20250126135402-20250126165402-00009.warc.wet.gz
2025-12-01 19:20:50,188 - src.ingest.download_commoncrawl - INFO - Downloaded partial: data/raw/commoncrawl/partial_CC-MAIN-20250126135402-20250126165402-00001.warc.wet.gz (10485761 bytes)
2025-12-01 19:20:50,212 - src.ingest.download_commoncrawl - INFO - Downloaded partial: data/raw/commoncrawl/partial_CC-MAIN-20250126135402-20250126165402-00005.warc.wet.gz (10485761 bytes)
2025-12-01 19:20:50,265 - src.ingest.download_commoncrawl - INFO - Downloaded partial: data/raw/commoncrawl/partial_CC-MAIN-20250126135402-20250126165402-00007.warc.wet.gz (10485761 bytes)
2025-12-01 19:20:50,271 - src.ingest.download_commoncrawl - INFO - Downloaded partial: data/raw/commoncrawl/partial_CC-MAIN-20250126135402-20250126165402-00002.warc.wet.gz (10485761 bytes)
2025-12-01 19:20:50,282 - src.ingest.download_commoncrawl - INFO - Downloaded partial: data/raw/commoncrawl/partial_CC-MAIN-20250126135402-20250126165402-00004.warc.wet.gz (10485761 bytes)
2025-12-01 19:20:50,286 - src.ingest.download_commoncrawl - INFO - Downloaded partial: data/raw/commoncrawl/partial_CC-MAIN-20250126135402-20250126165402-00006.warc.wet.gz (10485761 bytes)
2025-12-01 19:20:52,444 - src.ingest.download_commoncrawl - INFO - Downloaded partial: data/raw/commoncrawl/partial_CC-MAIN-20250126135402-20250126165402-00008.warc.wet.gz (10485761 bytes)
2025-12-01 19:20:52,477 - src.ingest.download_commoncrawl - INFO - Downloaded partial: data/raw/commoncrawl/partial_CC-MAIN-20250126135402-20250126165402-00009.warc.wet.gz (10485761 bytes)
2025-12-01 19:20:52,480 - src.ingest.download_commoncrawl - INFO - Download progress: 10/10 (10 successful)
2025-12-01 19:20:52,482 - src.ingest.download_commoncrawl - INFO - Parallel download complete: 10/10 successful
2025-12-01 19:20:52,482 - __main__ - INFO - Parsing 10 WET files in parallel with 8 workers
2025-12-01 19:20:55,521 - src.ingest.parse_commoncrawl - INFO - Parsing WET file: data/raw/commoncrawl/partial_CC-MAIN-20250126135402-20250126165402-00003.warc.wet.gz
2025-12-01 19:20:55,725 - src.ingest.parse_commoncrawl - INFO - Parsing WET file: data/raw/commoncrawl/partial_CC-MAIN-20250126135402-20250126165402-00000.warc.wet.gz
2025-12-01 19:20:55,728 - src.ingest.parse_commoncrawl - INFO - Parsing WET file: data/raw/commoncrawl/partial_CC-MAIN-20250126135402-20250126165402-00001.warc.wet.gz
2025-12-01 19:20:55,729 - src.ingest.parse_commoncrawl - INFO - Parsing WET file: data/raw/commoncrawl/partial_CC-MAIN-20250126135402-20250126165402-00005.warc.wet.gz
2025-12-01 19:20:55,735 - src.ingest.parse_commoncrawl - INFO - Parsing WET file: data/raw/commoncrawl/partial_CC-MAIN-20250126135402-20250126165402-00007.warc.wet.gz
2025-12-01 19:20:55,856 - src.ingest.parse_commoncrawl - INFO - Parsing WET file: data/raw/commoncrawl/partial_CC-MAIN-20250126135402-20250126165402-00002.warc.wet.gz
2025-12-01 19:20:55,863 - src.ingest.parse_commoncrawl - INFO - Parsing WET file: data/raw/commoncrawl/partial_CC-MAIN-20250126135402-20250126165402-00006.warc.wet.gz
2025-12-01 19:20:55,865 - src.ingest.parse_commoncrawl - INFO - Parsing WET file: data/raw/commoncrawl/partial_CC-MAIN-20250126135402-20250126165402-00004.warc.wet.gz
2025-12-01 19:20:56,924 - src.ingest.parse_commoncrawl - WARNING - Truncated gzip file detected (partial download?): data/raw/commoncrawl/partial_CC-MAIN-20250126135402-20250126165402-00001.warc.wet.gz
2025-12-01 19:20:56,924 - src.ingest.parse_commoncrawl - INFO - Successfully parsed 17 records before truncation
2025-12-01 19:20:56,925 - src.ingest.parse_commoncrawl - INFO - Parsing WET file: data/raw/commoncrawl/partial_CC-MAIN-20250126135402-20250126165402-00008.warc.wet.gz
2025-12-01 19:20:57,034 - src.ingest.parse_commoncrawl - WARNING - Truncated gzip file detected (partial download?): data/raw/commoncrawl/partial_CC-MAIN-20250126135402-20250126165402-00003.warc.wet.gz
2025-12-01 19:20:57,038 - src.ingest.parse_commoncrawl - INFO - Successfully parsed 18 records before truncation
2025-12-01 19:20:57,038 - src.ingest.parse_commoncrawl - INFO - Parsing WET file: data/raw/commoncrawl/partial_CC-MAIN-20250126135402-20250126165402-00009.warc.wet.gz
2025-12-01 19:20:57,210 - src.ingest.parse_commoncrawl - WARNING - Truncated gzip file detected (partial download?): data/raw/commoncrawl/partial_CC-MAIN-20250126135402-20250126165402-00002.warc.wet.gz
2025-12-01 19:20:57,213 - src.ingest.parse_commoncrawl - INFO - Successfully parsed 18 records before truncation
2025-12-01 19:20:57,235 - src.ingest.parse_commoncrawl - WARNING - Truncated gzip file detected (partial download?): data/raw/commoncrawl/partial_CC-MAIN-20250126135402-20250126165402-00000.warc.wet.gz
2025-12-01 19:20:57,239 - src.ingest.parse_commoncrawl - INFO - Successfully parsed 17 records before truncation
2025-12-01 19:20:57,240 - src.ingest.parse_commoncrawl - WARNING - Truncated gzip file detected (partial download?): data/raw/commoncrawl/partial_CC-MAIN-20250126135402-20250126165402-00007.warc.wet.gz
2025-12-01 19:20:57,240 - src.ingest.parse_commoncrawl - INFO - Successfully parsed 17 records before truncation
2025-12-01 19:20:57,248 - src.ingest.parse_commoncrawl - WARNING - Truncated gzip file detected (partial download?): data/raw/commoncrawl/partial_CC-MAIN-20250126135402-20250126165402-00006.warc.wet.gz
2025-12-01 19:20:57,249 - src.ingest.parse_commoncrawl - INFO - Successfully parsed 15 records before truncation
2025-12-01 19:20:57,274 - src.ingest.parse_commoncrawl - WARNING - Truncated gzip file detected (partial download?): data/raw/commoncrawl/partial_CC-MAIN-20250126135402-20250126165402-00004.warc.wet.gz
2025-12-01 19:20:57,274 - src.ingest.parse_commoncrawl - WARNING - Truncated gzip file detected (partial download?): data/raw/commoncrawl/partial_CC-MAIN-20250126135402-20250126165402-00005.warc.wet.gz
2025-12-01 19:20:57,274 - src.ingest.parse_commoncrawl - INFO - Successfully parsed 18 records before truncation
2025-12-01 19:20:57,274 - src.ingest.parse_commoncrawl - INFO - Successfully parsed 16 records before truncation
2025-12-01 19:20:57,709 - src.ingest.parse_commoncrawl - WARNING - Truncated gzip file detected (partial download?): data/raw/commoncrawl/partial_CC-MAIN-20250126135402-20250126165402-00008.warc.wet.gz
2025-12-01 19:20:57,709 - src.ingest.parse_commoncrawl - INFO - Successfully parsed 10 records before truncation
spark config {'app_name': 'AustraliaCompanyETL', 'master': 'local[*]', 'driver_memory': '4g', 'executor_memory': '4g', 'shuffle_partitions': 200}
WARNING: Using incubator modules: jdk.incubator.vector
Warning: Ignoring non-Spark config property: shuffle_partitions
Warning: Ignoring non-Spark config property: executor_memory
Warning: Ignoring non-Spark config property: app_name
Warning: Ignoring non-Spark config property: driver_memory
:: loading settings :: url = jar:file:/home/ubuntu/.local/lib/python3.12/site-packages/pyspark/jars/ivy-2.5.3.jar!/org/apache/ivy/core/settings/ivysettings.xml
Ivy Default Cache set to: /home/ubuntu/.ivy2.5.2/cache
The jars for the packages stored in: /home/ubuntu/.ivy2.5.2/jars
com.databricks#spark-xml_2.12 added as a dependency
:: resolving dependencies :: org.apache.spark#spark-submit-parent-531d8cdb-0e88-45c5-8ad9-bc61b96cafac;1.0
        confs: [default]
        found com.databricks#spark-xml_2.12;0.17.0 in central
        found commons-io#commons-io;2.11.0 in central
        found org.glassfish.jaxb#txw2;3.0.2 in central
        found org.apache.ws.xmlschema#xmlschema-core;2.3.0 in central
        found org.scala-lang.modules#scala-collection-compat_2.12;2.9.0 in central
:: resolution report :: resolve 328ms :: artifacts dl 14ms
        :: modules in use:
        com.databricks#spark-xml_2.12;0.17.0 from central in [default]
        commons-io#commons-io;2.11.0 from central in [default]
        org.apache.ws.xmlschema#xmlschema-core;2.3.0 from central in [default]
        org.glassfish.jaxb#txw2;3.0.2 from central in [default]
        org.scala-lang.modules#scala-collection-compat_2.12;2.9.0 from central in [default]
        ---------------------------------------------------------------------
        |                  |            modules            ||   artifacts   |
        |       conf       | number| search|dwnlded|evicted|| number|dwnlded|
        ---------------------------------------------------------------------
        |      default     |   5   |   0   |   0   |   0   ||   5   |   0   |
        ---------------------------------------------------------------------
:: retrieving :: org.apache.spark#spark-submit-parent-531d8cdb-0e88-45c5-8ad9-bc61b96cafac
        confs: [default]
        0 artifacts copied, 5 already retrieved (0kB/8ms)
25/12/01 19:21:02 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
Using Spark's default log4j profile: org/apache/spark/log4j2-defaults.properties
Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
2025-12-01 19:21:12,435 - __main__ - INFO - Extracted 165 Common Crawl records  
2025-12-01 19:21:12,435 - __main__ - INFO - Extracting ABR data...
2025-12-01 19:21:12,438 - src.ingest.download_abr - INFO - File already exists: data/processed/abr/public_split_1_10.zip
2025-12-01 19:21:12,438 - src.ingest.download_abr - INFO - Extracting: data/processed/abr/public_split_1_10.zip
2025-12-01 19:21:17,954 - src.ingest.download_abr - INFO - Extracted: 20251126_Public01.xml
2025-12-01 19:21:23,440 - src.ingest.download_abr - INFO - Extracted: 20251126_Public02.xml
2025-12-01 19:21:28,919 - src.ingest.download_abr - INFO - Extracted: 20251126_Public03.xml
2025-12-01 19:21:34,376 - src.ingest.download_abr - INFO - Extracted: 20251126_Public04.xml
2025-12-01 19:21:39,873 - src.ingest.download_abr - INFO - Extracted: 20251126_Public05.xml
2025-12-01 19:21:45,348 - src.ingest.download_abr - INFO - Extracted: 20251126_Public06.xml
2025-12-01 19:21:50,856 - src.ingest.download_abr - INFO - Extracted: 20251126_Public07.xml
2025-12-01 19:21:56,338 - src.ingest.download_abr - INFO - Extracted: 20251126_Public08.xml
2025-12-01 19:22:01,828 - src.ingest.download_abr - INFO - Extracted: 20251126_Public09.xml
2025-12-01 19:22:07,305 - src.ingest.download_abr - INFO - Extracted: 20251126_Public10.xml
2025-12-01 19:22:07,305 - src.ingest.download_abr - INFO - Total XML files: 10
2025-12-01 19:22:07,305 - __main__ - INFO - Parsing 10 ABR files in parallel with 8 workers
2025-12-01 19:22:10,365 - src.ingest.parse_abr - INFO - Parsing ABR file: data/processed/abr/20251126_Public01.xml
2025-12-01 19:22:10,603 - src.ingest.parse_abr - INFO - Parsing ABR file: data/processed/abr/20251126_Public02.xml
2025-12-01 19:22:10,604 - src.ingest.parse_abr - INFO - Parsing ABR file: data/processed/abr/20251126_Public03.xml
2025-12-01 19:22:10,621 - src.ingest.parse_abr - INFO - Parsing ABR file: data/processed/abr/20251126_Public04.xml
2025-12-01 19:22:10,625 - src.ingest.parse_abr - INFO - Parsing ABR file: data/processed/abr/20251126_Public05.xml
2025-12-01 19:22:10,683 - src.ingest.parse_abr - INFO - Parsing ABR file: data/processed/abr/20251126_Public06.xml
2025-12-01 19:22:10,684 - src.ingest.parse_abr - INFO - Parsing ABR file: data/processed/abr/20251126_Public07.xml
2025-12-01 19:22:10,699 - src.ingest.parse_abr - INFO - Parsing ABR file: data/processed/abr/20251126_Public08.xml
2025-12-01 19:22:37,777 - src.ingest.parse_abr - INFO - Parsed 200000 records from data/processed/abr/20251126_Public07.xml
2025-12-01 19:22:38,167 - src.ingest.parse_abr - INFO - Parsed 200000 records from data/processed/abr/20251126_Public01.xml
2025-12-01 19:22:38,647 - src.ingest.parse_abr - INFO - Parsed 200000 records from data/processed/abr/20251126_Public04.xml
2025-12-01 19:22:38,648 - src.ingest.parse_abr - INFO - Parsed 200000 records from data/processed/abr/20251126_Public06.xml
2025-12-01 19:22:38,803 - src.ingest.parse_abr - INFO - Parsed 200000 records from data/processed/abr/20251126_Public02.xml
2025-12-01 19:22:38,836 - src.ingest.parse_abr - INFO - Parsed 200000 records from data/processed/abr/20251126_Public03.xml
2025-12-01 19:22:39,026 - src.ingest.parse_abr - INFO - Parsed 200000 records from data/processed/abr/20251126_Public08.xml
2025-12-01 19:22:39,279 - src.ingest.parse_abr - INFO - Parsed 200000 records from data/processed/abr/20251126_Public05.xml
2025-12-01 19:22:39,283 - src.ingest.parse_abr - INFO - Parsing ABR file: data/processed/abr/20251126_Public09.xml
2025-12-01 19:22:39,895 - src.ingest.parse_abr - INFO - Parsing ABR file: data/processed/abr/20251126_Public10.xml
2025-12-01 19:22:53,752 - src.ingest.parse_abr - INFO - Parsed 200000 records from data/processed/abr/20251126_Public09.xml
2025-12-01 19:22:54,210 - src.ingest.parse_abr - INFO - Parsed 200000 records from data/processed/abr/20251126_Public10.xml
25/12/01 19:23:05 WARN TaskSetManager: Stage 3 contains a task of very large size (50330 KiB). The maximum recommended task size is 1000 KiB.
2025-12-01 19:23:08,227 - __main__ - INFO - Extracted 2000000 ABR records       
25/12/01 19:23:09 WARN TaskSetManager: Stage 9 contains a task of very large size (50330 KiB). The maximum recommended task size is 1000 KiB.
2025-12-01 19:23:11,786 - __main__ - INFO - ==================================================
2025-12-01 19:23:11,786 - __main__ - INFO - STEP 2: TRANSFORM
2025-12-01 19:23:11,786 - __main__ - INFO - ==================================================
2025-12-01 19:23:11,786 - __main__ - WARNING - Starting call to '__main__.ETLPipeline.transform', this is the 1st time calling it.
2025-12-01 19:23:12,086 - __main__ - INFO - Cleaning Common Crawl data with Spark...
2025-12-01 19:23:17,756 - __main__ - INFO - Cleaned CC data: 85 records         
25/12/01 19:23:17 WARN TaskSetManager: Stage 21 contains a task of very large size (50330 KiB). The maximum recommended task size is 1000 KiB.
2025-12-01 19:23:20,243 - __main__ - INFO - Cleaning ABR data with Spark...     
25/12/01 19:23:20 WARN TaskSetManager: Stage 24 contains a task of very large size (50330 KiB). The maximum recommended task size is 1000 KiB.
2025-12-01 19:23:40,849 - __main__ - INFO - Cleaned ABR data: 1999993 records   
25/12/01 19:23:41 WARN TaskSetManager: Stage 36 contains a task of very large size (50330 KiB). The maximum recommended task size is 1000 KiB.
2025-12-01 19:24:01,328 - __main__ - INFO - ==================================================
2025-12-01 19:24:01,328 - __main__ - INFO - STEP 3: ENTITY MATCHING
2025-12-01 19:24:01,328 - __main__ - INFO - ==================================================
2025-12-01 19:24:01,328 - __main__ - WARNING - Starting call to '__main__.ETLPipeline.match', this is the 1st time calling it.
25/12/01 19:24:02 WARN TaskSetManager: Stage 48 contains a task of very large size (50330 KiB). The maximum recommended task size is 1000 KiB.
25/12/01 19:24:22 WARN TaskSetManager: Stage 60 contains a task of very large size (50330 KiB). The maximum recommended task size is 1000 KiB.
2025-12-01 19:24:41,448 - __main__ - INFO - Matching 85 CC records with 1999993 ABR records using Spark
25/12/01 19:24:43 WARN TaskSetManager: Stage 67 contains a task of very large size (50330 KiB). The maximum recommended task size is 1000 KiB.
2025-12-01 19:25:13,988 - __main__ - INFO - Found 78 matches                    
25/12/01 19:25:14 WARN TaskSetManager: Stage 76 contains a task of very large size (50330 KiB). The maximum recommended task size is 1000 KiB.
25/12/01 19:25:44 WARN TaskSetManager: Stage 85 contains a task of very large size (50330 KiB). The maximum recommended task size is 1000 KiB.
2025-12-01 19:26:13,086 - __main__ - INFO - Average match score: 81.78%         
25/12/01 19:26:13 WARN TaskSetManager: Stage 93 contains a task of very large size (50330 KiB). The maximum recommended task size is 1000 KiB.
2025-12-01 19:26:42,455 - __main__ - INFO - ==================================================
2025-12-01 19:26:42,455 - __main__ - INFO - STEP 4: LOAD
2025-12-01 19:26:42,455 - __main__ - INFO - ==================================================
2025-12-01 19:26:42,455 - __main__ - WARNING - Starting call to '__main__.ETLPipeline.load', this is the 1st time calling it.
2025-12-01 19:26:42,455 - __main__ - INFO - Creating database tables...
2025-12-01 19:26:42,455 - src.load.load_postgres - INFO - Creating tables from: src/load/create_tables.sql
2025-12-01 19:26:42,636 - src.load.load_postgres - INFO - Tables created successfully
/home/ubuntu/.local/lib/python3.12/site-packages/pyspark/sql/pandas/conversion.py:95: UserWarning: toPandas attempted Arrow optimization because 'spark.sql.execution.arrow.pyspark.enabled' is set to true; however, failed by the reason below:
  [PACKAGE_NOT_INSTALLED] PyArrow >= 11.0.0 must be installed; however, it was not found.
Attempting non-optimization as 'spark.sql.execution.arrow.pyspark.fallback.enabled' is set to true.
  warn(msg)
25/12/01 19:26:44 WARN TaskSetManager: Stage 111 contains a task of very large size (50330 KiB). The maximum recommended task size is 1000 KiB.
25/12/01 19:27:03 WARN TaskSetManager: Stage 117 contains a task of very large size (50330 KiB). The maximum recommended task size is 1000 KiB.
25/12/01 19:27:58 WARN TaskSetManager: Stage 121 contains a task of very large size (50330 KiB). The maximum recommended task size is 1000 KiB.
25/12/01 19:28:29 WARN TaskSetManager: Stage 130 contains a task of very large size (50330 KiB). The maximum recommended task size is 1000 KiB.
2025-12-01 19:29:08,526 - __main__ - INFO - Loading Common Crawl data...        
2025-12-01 19:29:08,526 - src.load.load_postgres - INFO - Loading 85 web companies
2025-12-01 19:29:08,586 - src.load.load_postgres - INFO - Loaded 85 web companies
2025-12-01 19:29:08,587 - __main__ - INFO - Loading ABR data...
2025-12-01 19:29:08,587 - src.load.load_postgres - INFO - Loading 1999993 ABR entities
2025-12-01 19:29:29,496 - src.load.load_postgres - INFO - Loaded 10000 records...
2025-12-01 19:29:31,368 - src.load.load_postgres - INFO - Loaded 20000 records...
2025-12-01 19:29:33,151 - src.load.load_postgres - INFO - Loaded 30000 records...
2025-12-01 19:29:34,909 - src.load.load_postgres - INFO - Loaded 40000 records...
2025-12-01 19:29:36,593 - src.load.load_postgres - INFO - Loaded 50000 records...
2025-12-01 19:29:38,433 - src.load.load_postgres - INFO - Loaded 60000 records...
2025-12-01 19:29:40,659 - src.load.load_postgres - INFO - Loaded 70000 records...
2025-12-01 19:29:42,390 - src.load.load_postgres - INFO - Loaded 80000 records...
2025-12-01 19:29:44,110 - src.load.load_postgres - INFO - Loaded 90000 records...
2025-12-01 19:29:45,820 - src.load.load_postgres - INFO - Loaded 100000 records...
2025-12-01 19:29:47,487 - src.load.load_postgres - INFO - Loaded 110000 records...
2025-12-01 19:29:49,174 - src.load.load_postgres - INFO - Loaded 120000 records...
2025-12-01 19:29:50,854 - src.load.load_postgres - INFO - Loaded 130000 records...
2025-12-01 19:29:52,534 - src.load.load_postgres - INFO - Loaded 140000 records...
2025-12-01 19:29:54,201 - src.load.load_postgres - INFO - Loaded 150000 records...
2025-12-01 19:29:55,875 - src.load.load_postgres - INFO - Loaded 160000 records...
2025-12-01 19:29:57,547 - src.load.load_postgres - INFO - Loaded 170000 records...
2025-12-01 19:29:59,209 - src.load.load_postgres - INFO - Loaded 180000 records...
2025-12-01 19:30:00,867 - src.load.load_postgres - INFO - Loaded 190000 records...
2025-12-01 19:30:02,513 - src.load.load_postgres - INFO - Loaded 200000 records...
2025-12-01 19:30:04,137 - src.load.load_postgres - INFO - Loaded 210000 records...
2025-12-01 19:30:05,773 - src.load.load_postgres - INFO - Loaded 220000 records...
2025-12-01 19:30:07,433 - src.load.load_postgres - INFO - Loaded 230000 records...
2025-12-01 19:30:09,118 - src.load.load_postgres - INFO - Loaded 240000 records...
2025-12-01 19:30:10,776 - src.load.load_postgres - INFO - Loaded 250000 records...
2025-12-01 19:30:12,451 - src.load.load_postgres - INFO - Loaded 260000 records...
2025-12-01 19:30:14,143 - src.load.load_postgres - INFO - Loaded 270000 records...
2025-12-01 19:30:15,844 - src.load.load_postgres - INFO - Loaded 280000 records...
2025-12-01 19:30:17,480 - src.load.load_postgres - INFO - Loaded 290000 records...
2025-12-01 19:30:19,132 - src.load.load_postgres - INFO - Loaded 300000 records...
2025-12-01 19:30:20,804 - src.load.load_postgres - INFO - Loaded 310000 records...
2025-12-01 19:30:22,462 - src.load.load_postgres - INFO - Loaded 320000 records...
2025-12-01 19:30:24,103 - src.load.load_postgres - INFO - Loaded 330000 records...
2025-12-01 19:30:25,747 - src.load.load_postgres - INFO - Loaded 340000 records...
2025-12-01 19:30:27,363 - src.load.load_postgres - INFO - Loaded 350000 records...
2025-12-01 19:30:29,011 - src.load.load_postgres - INFO - Loaded 360000 records...
2025-12-01 19:30:30,657 - src.load.load_postgres - INFO - Loaded 370000 records...
2025-12-01 19:30:32,309 - src.load.load_postgres - INFO - Loaded 380000 records...
2025-12-01 19:30:33,945 - src.load.load_postgres - INFO - Loaded 390000 records...
2025-12-01 19:30:35,563 - src.load.load_postgres - INFO - Loaded 400000 records...
2025-12-01 19:30:37,210 - src.load.load_postgres - INFO - Loaded 410000 records...
2025-12-01 19:30:38,848 - src.load.load_postgres - INFO - Loaded 420000 records...
2025-12-01 19:30:40,490 - src.load.load_postgres - INFO - Loaded 430000 records...
2025-12-01 19:30:42,107 - src.load.load_postgres - INFO - Loaded 440000 records...
2025-12-01 19:30:43,743 - src.load.load_postgres - INFO - Loaded 450000 records...
2025-12-01 19:30:45,365 - src.load.load_postgres - INFO - Loaded 460000 records...
2025-12-01 19:30:46,990 - src.load.load_postgres - INFO - Loaded 470000 records...
2025-12-01 19:30:48,653 - src.load.load_postgres - INFO - Loaded 480000 records...
2025-12-01 19:30:50,326 - src.load.load_postgres - INFO - Loaded 490000 records...
2025-12-01 19:30:51,965 - src.load.load_postgres - INFO - Loaded 500000 records...
2025-12-01 19:30:53,598 - src.load.load_postgres - INFO - Loaded 510000 records...
2025-12-01 19:30:55,268 - src.load.load_postgres - INFO - Loaded 520000 records...
2025-12-01 19:30:56,902 - src.load.load_postgres - INFO - Loaded 530000 records...
2025-12-01 19:30:58,584 - src.load.load_postgres - INFO - Loaded 540000 records...
2025-12-01 19:31:00,303 - src.load.load_postgres - INFO - Loaded 550000 records...
2025-12-01 19:31:01,916 - src.load.load_postgres - INFO - Loaded 560000 records...
2025-12-01 19:31:03,544 - src.load.load_postgres - INFO - Loaded 570000 records...
2025-12-01 19:31:05,178 - src.load.load_postgres - INFO - Loaded 580000 records...
2025-12-01 19:31:06,780 - src.load.load_postgres - INFO - Loaded 590000 records...
2025-12-01 19:31:08,409 - src.load.load_postgres - INFO - Loaded 600000 records...
2025-12-01 19:31:10,037 - src.load.load_postgres - INFO - Loaded 610000 records...
2025-12-01 19:31:11,648 - src.load.load_postgres - INFO - Loaded 620000 records...
2025-12-01 19:31:13,273 - src.load.load_postgres - INFO - Loaded 630000 records...
2025-12-01 19:31:14,881 - src.load.load_postgres - INFO - Loaded 640000 records...
2025-12-01 19:31:16,495 - src.load.load_postgres - INFO - Loaded 650000 records...
2025-12-01 19:31:18,109 - src.load.load_postgres - INFO - Loaded 660000 records...
2025-12-01 19:31:19,769 - src.load.load_postgres - INFO - Loaded 670000 records...
2025-12-01 19:31:21,379 - src.load.load_postgres - INFO - Loaded 680000 records...
2025-12-01 19:31:22,993 - src.load.load_postgres - INFO - Loaded 690000 records...
2025-12-01 19:31:24,626 - src.load.load_postgres - INFO - Loaded 700000 records...
2025-12-01 19:31:26,259 - src.load.load_postgres - INFO - Loaded 710000 records...
2025-12-01 19:31:27,875 - src.load.load_postgres - INFO - Loaded 720000 records...
2025-12-01 19:31:29,552 - src.load.load_postgres - INFO - Loaded 730000 records...
2025-12-01 19:31:31,173 - src.load.load_postgres - INFO - Loaded 740000 records...
2025-12-01 19:31:32,798 - src.load.load_postgres - INFO - Loaded 750000 records...
2025-12-01 19:31:34,413 - src.load.load_postgres - INFO - Loaded 760000 records...
2025-12-01 19:31:36,076 - src.load.load_postgres - INFO - Loaded 770000 records...
2025-12-01 19:31:37,750 - src.load.load_postgres - INFO - Loaded 780000 records...
2025-12-01 19:31:39,386 - src.load.load_postgres - INFO - Loaded 790000 records...
2025-12-01 19:31:41,018 - src.load.load_postgres - INFO - Loaded 800000 records...
2025-12-01 19:31:42,655 - src.load.load_postgres - INFO - Loaded 810000 records...
2025-12-01 19:31:44,407 - src.load.load_postgres - INFO - Loaded 820000 records...
2025-12-01 19:31:45,952 - src.load.load_postgres - INFO - Loaded 830000 records...
2025-12-01 19:31:47,694 - src.load.load_postgres - INFO - Loaded 840000 records...
2025-12-01 19:31:49,358 - src.load.load_postgres - INFO - Loaded 850000 records...
2025-12-01 19:31:50,971 - src.load.load_postgres - INFO - Loaded 860000 records...
2025-12-01 19:31:52,641 - src.load.load_postgres - INFO - Loaded 870000 records...
2025-12-01 19:31:54,293 - src.load.load_postgres - INFO - Loaded 880000 records...
2025-12-01 19:31:55,948 - src.load.load_postgres - INFO - Loaded 890000 records...
2025-12-01 19:31:57,605 - src.load.load_postgres - INFO - Loaded 900000 records...
2025-12-01 19:31:59,293 - src.load.load_postgres - INFO - Loaded 910000 records...
2025-12-01 19:32:00,904 - src.load.load_postgres - INFO - Loaded 920000 records...
2025-12-01 19:32:02,432 - src.load.load_postgres - INFO - Loaded 930000 records...
2025-12-01 19:32:04,165 - src.load.load_postgres - INFO - Loaded 940000 records...
2025-12-01 19:32:05,845 - src.load.load_postgres - INFO - Loaded 950000 records...
2025-12-01 19:32:07,371 - src.load.load_postgres - INFO - Loaded 960000 records...
2025-12-01 19:32:09,034 - src.load.load_postgres - INFO - Loaded 970000 records...
2025-12-01 19:32:10,744 - src.load.load_postgres - INFO - Loaded 980000 records...
2025-12-01 19:32:12,297 - src.load.load_postgres - INFO - Loaded 990000 records...
2025-12-01 19:32:13,934 - src.load.load_postgres - INFO - Loaded 1000000 records...
2025-12-01 19:32:15,553 - src.load.load_postgres - INFO - Loaded 1010000 records...
2025-12-01 19:32:17,205 - src.load.load_postgres - INFO - Loaded 1020000 records...
2025-12-01 19:32:18,881 - src.load.load_postgres - INFO - Loaded 1030000 records...
2025-12-01 19:32:20,498 - src.load.load_postgres - INFO - Loaded 1040000 records...
2025-12-01 19:32:22,133 - src.load.load_postgres - INFO - Loaded 1050000 records...
2025-12-01 19:32:23,759 - src.load.load_postgres - INFO - Loaded 1060000 records...
2025-12-01 19:32:25,399 - src.load.load_postgres - INFO - Loaded 1070000 records...
2025-12-01 19:32:27,046 - src.load.load_postgres - INFO - Loaded 1080000 records...
2025-12-01 19:32:28,721 - src.load.load_postgres - INFO - Loaded 1090000 records...
2025-12-01 19:32:30,458 - src.load.load_postgres - INFO - Loaded 1100000 records...
2025-12-01 19:32:32,055 - src.load.load_postgres - INFO - Loaded 1110000 records...
2025-12-01 19:32:33,665 - src.load.load_postgres - INFO - Loaded 1120000 records...
2025-12-01 19:32:35,276 - src.load.load_postgres - INFO - Loaded 1130000 records...
2025-12-01 19:32:36,882 - src.load.load_postgres - INFO - Loaded 1140000 records...
2025-12-01 19:32:38,542 - src.load.load_postgres - INFO - Loaded 1150000 records...
2025-12-01 19:32:40,186 - src.load.load_postgres - INFO - Loaded 1160000 records...
2025-12-01 19:32:41,802 - src.load.load_postgres - INFO - Loaded 1170000 records...
2025-12-01 19:32:43,414 - src.load.load_postgres - INFO - Loaded 1180000 records...
2025-12-01 19:32:45,042 - src.load.load_postgres - INFO - Loaded 1190000 records...
2025-12-01 19:32:46,664 - src.load.load_postgres - INFO - Loaded 1200000 records...
2025-12-01 19:32:48,277 - src.load.load_postgres - INFO - Loaded 1210000 records...
2025-12-01 19:32:49,913 - src.load.load_postgres - INFO - Loaded 1220000 records...
2025-12-01 19:32:51,549 - src.load.load_postgres - INFO - Loaded 1230000 records...
2025-12-01 19:32:53,161 - src.load.load_postgres - INFO - Loaded 1240000 records...
2025-12-01 19:32:54,818 - src.load.load_postgres - INFO - Loaded 1250000 records...
2025-12-01 19:32:56,456 - src.load.load_postgres - INFO - Loaded 1260000 records...
2025-12-01 19:32:58,135 - src.load.load_postgres - INFO - Loaded 1270000 records...
2025-12-01 19:32:59,782 - src.load.load_postgres - INFO - Loaded 1280000 records...
2025-12-01 19:33:01,374 - src.load.load_postgres - INFO - Loaded 1290000 records...
2025-12-01 19:33:03,005 - src.load.load_postgres - INFO - Loaded 1300000 records...
2025-12-01 19:33:04,675 - src.load.load_postgres - INFO - Loaded 1310000 records...
2025-12-01 19:33:06,310 - src.load.load_postgres - INFO - Loaded 1320000 records...
2025-12-01 19:33:07,945 - src.load.load_postgres - INFO - Loaded 1330000 records...
2025-12-01 19:33:09,589 - src.load.load_postgres - INFO - Loaded 1340000 records...
2025-12-01 19:33:11,219 - src.load.load_postgres - INFO - Loaded 1350000 records...
2025-12-01 19:33:12,845 - src.load.load_postgres - INFO - Loaded 1360000 records...
2025-12-01 19:33:14,604 - src.load.load_postgres - INFO - Loaded 1370000 records...
2025-12-01 19:33:16,229 - src.load.load_postgres - INFO - Loaded 1380000 records...
2025-12-01 19:33:17,850 - src.load.load_postgres - INFO - Loaded 1390000 records...
2025-12-01 19:33:19,478 - src.load.load_postgres - INFO - Loaded 1400000 records...
2025-12-01 19:33:21,109 - src.load.load_postgres - INFO - Loaded 1410000 records...
2025-12-01 19:33:22,767 - src.load.load_postgres - INFO - Loaded 1420000 records...
2025-12-01 19:33:24,428 - src.load.load_postgres - INFO - Loaded 1430000 records...
2025-12-01 19:33:26,047 - src.load.load_postgres - INFO - Loaded 1440000 records...
2025-12-01 19:33:27,700 - src.load.load_postgres - INFO - Loaded 1450000 records...
2025-12-01 19:33:29,332 - src.load.load_postgres - INFO - Loaded 1460000 records...
2025-12-01 19:33:30,942 - src.load.load_postgres - INFO - Loaded 1470000 records...
2025-12-01 19:33:32,603 - src.load.load_postgres - INFO - Loaded 1480000 records...
2025-12-01 19:33:34,240 - src.load.load_postgres - INFO - Loaded 1490000 records...
2025-12-01 19:33:35,854 - src.load.load_postgres - INFO - Loaded 1500000 records...
2025-12-01 19:33:37,501 - src.load.load_postgres - INFO - Loaded 1510000 records...
2025-12-01 19:33:39,113 - src.load.load_postgres - INFO - Loaded 1520000 records...
2025-12-01 19:33:40,738 - src.load.load_postgres - INFO - Loaded 1530000 records...
2025-12-01 19:33:42,394 - src.load.load_postgres - INFO - Loaded 1540000 records...
2025-12-01 19:33:44,049 - src.load.load_postgres - INFO - Loaded 1550000 records...
2025-12-01 19:33:45,718 - src.load.load_postgres - INFO - Loaded 1560000 records...
2025-12-01 19:33:47,385 - src.load.load_postgres - INFO - Loaded 1570000 records...
2025-12-01 19:33:49,048 - src.load.load_postgres - INFO - Loaded 1580000 records...
2025-12-01 19:33:50,667 - src.load.load_postgres - INFO - Loaded 1590000 records...
2025-12-01 19:33:52,295 - src.load.load_postgres - INFO - Loaded 1600000 records...
2025-12-01 19:33:53,948 - src.load.load_postgres - INFO - Loaded 1610000 records...
2025-12-01 19:33:55,602 - src.load.load_postgres - INFO - Loaded 1620000 records...
2025-12-01 19:33:57,264 - src.load.load_postgres - INFO - Loaded 1630000 records...
2025-12-01 19:33:59,051 - src.load.load_postgres - INFO - Loaded 1640000 records...
2025-12-01 19:34:00,689 - src.load.load_postgres - INFO - Loaded 1650000 records...
2025-12-01 19:34:02,334 - src.load.load_postgres - INFO - Loaded 1660000 records...
2025-12-01 19:34:03,961 - src.load.load_postgres - INFO - Loaded 1670000 records...
2025-12-01 19:34:05,634 - src.load.load_postgres - INFO - Loaded 1680000 records...
2025-12-01 19:34:07,293 - src.load.load_postgres - INFO - Loaded 1690000 records...
2025-12-01 19:34:08,916 - src.load.load_postgres - INFO - Loaded 1700000 records...
2025-12-01 19:34:10,580 - src.load.load_postgres - INFO - Loaded 1710000 records...
2025-12-01 19:34:12,250 - src.load.load_postgres - INFO - Loaded 1720000 records...
2025-12-01 19:34:13,899 - src.load.load_postgres - INFO - Loaded 1730000 records...
2025-12-01 19:34:15,563 - src.load.load_postgres - INFO - Loaded 1740000 records...
2025-12-01 19:34:17,190 - src.load.load_postgres - INFO - Loaded 1750000 records...
2025-12-01 19:34:18,857 - src.load.load_postgres - INFO - Loaded 1760000 records...
2025-12-01 19:34:20,525 - src.load.load_postgres - INFO - Loaded 1770000 records...
2025-12-01 19:34:22,177 - src.load.load_postgres - INFO - Loaded 1780000 records...
2025-12-01 19:34:23,813 - src.load.load_postgres - INFO - Loaded 1790000 records...
2025-12-01 19:34:25,509 - src.load.load_postgres - INFO - Loaded 1800000 records...
2025-12-01 19:34:27,112 - src.load.load_postgres - INFO - Loaded 1810000 records...
2025-12-01 19:34:28,673 - src.load.load_postgres - INFO - Loaded 1820000 records...
2025-12-01 19:34:30,426 - src.load.load_postgres - INFO - Loaded 1830000 records...
2025-12-01 19:34:32,100 - src.load.load_postgres - INFO - Loaded 1840000 records...
2025-12-01 19:34:33,743 - src.load.load_postgres - INFO - Loaded 1850000 records...
2025-12-01 19:34:35,391 - src.load.load_postgres - INFO - Loaded 1860000 records...
2025-12-01 19:34:37,088 - src.load.load_postgres - INFO - Loaded 1870000 records...
2025-12-01 19:34:38,743 - src.load.load_postgres - INFO - Loaded 1880000 records...
2025-12-01 19:34:40,372 - src.load.load_postgres - INFO - Loaded 1890000 records...
2025-12-01 19:34:42,088 - src.load.load_postgres - INFO - Loaded 1900000 records...
2025-12-01 19:34:43,786 - src.load.load_postgres - INFO - Loaded 1910000 records...
2025-12-01 19:34:45,437 - src.load.load_postgres - INFO - Loaded 1920000 records...
2025-12-01 19:34:47,075 - src.load.load_postgres - INFO - Loaded 1930000 records...
2025-12-01 19:34:48,726 - src.load.load_postgres - INFO - Loaded 1940000 records...
2025-12-01 19:34:50,280 - src.load.load_postgres - INFO - Loaded 1950000 records...
2025-12-01 19:34:52,057 - src.load.load_postgres - INFO - Loaded 1960000 records...
2025-12-01 19:34:53,684 - src.load.load_postgres - INFO - Loaded 1970000 records...
2025-12-01 19:34:55,219 - src.load.load_postgres - INFO - Loaded 1980000 records...
2025-12-01 19:34:56,906 - src.load.load_postgres - INFO - Loaded 1990000 records...
2025-12-01 19:34:58,804 - src.load.load_postgres - INFO - Loaded 1999993 ABR entities
2025-12-01 19:34:59,072 - __main__ - INFO - Loading match results...
2025-12-01 19:34:59,072 - src.load.load_postgres - INFO - Loading 78 match results
2025-12-01 19:34:59,109 - src.load.load_postgres - INFO - Loaded 78 match results
2025-12-01 19:34:59,109 - __main__ - INFO - Creating unified company records...
2025-12-01 19:35:11,421 - src.load.load_postgres - INFO - Loading 78 unified companies
2025-12-01 19:35:11,464 - src.load.load_postgres - INFO - Loaded 78 unified companies
2025-12-01 19:35:12,176 - __main__ - INFO - ==================================================
2025-12-01 19:35:12,176 - __main__ - INFO - PIPELINE COMPLETED SUCCESSFULLY
2025-12-01 19:35:12,176 - __main__ - INFO - Duration: 865.46 seconds
2025-12-01 19:35:12,177 - __main__ - INFO - Matches found: 78
2025-12-01 19:35:12,177 - __main__ - INFO - ==================================================

==================================================
PIPELINE STATISTICS
==================================================
  Workers: 8
  run_id: b469d937
  started_at: 2025-12-01T19:20:46.714628
  status: completed
  cc_extracted: 165
  abr_extracted: 2000000
  cc_cleaned: 85
  abr_cleaned: 1999993
  matches_found: 78
  cc_loaded: 85
  abr_loaded: 1999993
  matches_loaded: 78
  unified_loaded: 78
  completed_at: 2025-12-01T19:35:12.176699
  duration_seconds: 865.462086
  